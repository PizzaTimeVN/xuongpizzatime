<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Qu·∫£n L√Ω X∆∞·ªüng Pizza Time</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f5f5;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            padding: 30px;
        }
        
        h1 {
            color: #333;
            margin-bottom: 30px;
            text-align: center;
            font-size: 28px;
        }
        
        .login-screen, .main-screen {
            display: none;
        }
        
        .login-screen.active, .main-screen.active {
            display: block;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            color: #555;
            font-weight: 600;
        }
        
        input[type="date"], input[type="text"], input[type="number"], select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: #e74c3c;
        }
        
        .btn {
            background: #e74c3c;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: background 0.3s;
        }
        
        .btn:hover {
            background: #c0392b;
        }
        
        .btn-secondary {
            background: #34495e;
        }
        
        .btn-secondary:hover {
            background: #2c3e50;
        }
        
        .btn-small {
            padding: 8px 16px;
            font-size: 14px;
        }
        
        .btn-danger {
            background: #e74c3c;
        }
        
        .menu-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .menu-card {
            background: #fff;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            padding: 30px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }
        
        .menu-card:hover {
            border-color: #e74c3c;
            transform: translateY(-4px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .menu-card h3 {
            color: #333;
            margin-bottom: 10px;
            font-size: 18px;
        }
        
        .menu-card p {
            color: #777;
            font-size: 14px;
        }
        
        .back-btn {
            margin-bottom: 20px;
        }
        
        .item-row {
            display: grid;
            grid-template-columns: 2fr 1fr 100px;
            gap: 10px;
            margin-bottom: 15px;
            align-items: center;
        }
        
        .items-container {
            margin: 20px 0;
        }
        
        .add-item-btn {
            margin: 20px 0;
        }
        
        .store-select {
            margin-bottom: 20px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        th {
            background: #f8f8f8;
            font-weight: 600;
            color: #333;
        }
        
        tr:hover {
            background: #f9f9f9;
        }
        
        .search-box {
            margin-bottom: 20px;
        }
        
        .alert {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
        }
        
        .alert-item {
            padding: 8px 0;
            border-bottom: 1px solid #ffe69c;
        }
        
        .alert-item:last-child {
            border-bottom: none;
        }
        
        .current-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .current-info span {
            font-weight: 600;
            color: #e74c3c;
        }
        
        .success-msg {
            background: #d4edda;
            border: 2px solid #28a745;
            color: #155724;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        input[type="password"] {
    width: 100%;
    padding: 12px;
    border: 2px solid #ddd;
    border-radius: 8px;
    font-size: 16px;
    background-color: #e0e0e0; /* n·ªÅn x√°m nh·∫°t */
    transition: border-color 0.3s, background-color 0.3s;
}

        input[type="password"]:focus {
            outline: none;
            border-color: #27ae60; /* xanh l√° khi focus */
            background-color: #d4f5d4; /* nh·∫°t h∆°n khi focus */
        }

        /* N√∫t B·∫Øt ƒë·∫ßu - xanh l√° */
        .btn-start {
            background: #27ae60;
            color: white;
        }

        .btn-start:hover {
            background: #2ecc71;
        }

        /* N√∫t ƒëƒÉng xu·∫•t - ƒë·ªè */
        .btn-logout {
            background: #e74c3c;
            color: white;
        }

        .btn-logout:hover {
            background: #c0392b;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Qu·∫£n L√Ω X∆∞·ªüng Pizza Time</h1>
        
        <!-- Login Screen -->
        <div class="login-screen active" id="loginScreen">
            <div class="form-group">
                <label>Ng√†y</label>
                <input type="date" id="loginDate" />
            </div>
            <div class="form-group">
                <label>T√™n ng∆∞·ªùi nh·∫≠p</label>
                <input type="text" id="loginName" placeholder="Nh·∫≠p t√™n c·ªßa b·∫°n" />
                    </div>
                    <div class="form-group">
                <label>M·∫≠t kh·∫©u</label>
                <input type="password" id="loginPassword" placeholder="Nh·∫≠p m·∫≠t kh·∫©u" />
            </div>
            <button class="btn btn-start" onclick="login()">B·∫Øt ƒê·∫ßu</button>
        </div>
        
        <!-- Main Screen -->
        <div class="main-screen" id="mainScreen">
            <div class="current-info">
                Ng√†y: <span id="currentDate"></span> | Ng∆∞·ªùi nh·∫≠p: <span id="currentUser"></span>
                <button class="btn btn-logout" onclick="logout()">ƒêƒÉng xu·∫•t</button>
            </div>

            <div class="menu-grid" id="menuGrid">
                <div class="menu-card" onclick="showScreen('rawInput')">
                    <h3>Nh·∫≠p H√†ng Th√¥</h3>
                    <p>Ghi nh·∫≠n nguy√™n li·ªáu nh·∫≠p kho</p>
                </div>
                <div class="menu-card" onclick="showScreen('productionInput')">
                    <h3>L√†m Th√†nh Ph·∫©m</h3>
                    <p>Ghi nh·∫≠n s·∫£n xu·∫•t th√†nh ph·∫©m</p>
                </div>
                <div class="menu-card" onclick="showScreen('exportProduct')">
                    <h3>Xu·∫•t Th√†nh Ph·∫©m</h3>
                    <p>Xu·∫•t h√†ng cho c√°c qu√°n</p>
                </div>
                <div class="menu-card" onclick="showScreen('inventory')">
                    <h3>T·ªìn Kho</h3>
                    <p>Xem v√† ƒëi·ªÅu ch·ªânh t·ªìn kho</p>
                </div>
                <div class="menu-card" onclick="showScreen('alerts')">
                    <h3>C·∫£nh B√°o H√†ng</h3>
                    <p>M·∫∑t h√†ng s·∫Øp h·∫øt</p>
                </div>
            </div>
        </div>

        
        <!-- Raw Input Screen -->
        <div id="rawInputScreen" style="display:none;">
            <button class="btn btn-secondary back-btn" onclick="backToMenu()">‚Üê Quay L·∫°i</button>
            <h2>Nh·∫≠p H√†ng Th√¥</h2>
            <div id="rawSuccessMsg"></div>
            <div class="items-container" id="rawItemsContainer"></div>
            <button class="btn add-item-btn" onclick="addRawItem()">+ Th√™m M·∫∑t H√†ng</button>
            <button class="btn" onclick="saveRawInput()">L∆∞u</button>
        </div>
        
        <!-- Production Input Screen -->
        <div id="productionInputScreen" style="display:none;">
            <button class="btn btn-secondary back-btn" onclick="backToMenu()">‚Üê Quay L·∫°i</button>
            <h2>L√†m Th√†nh Ph·∫©m</h2>
            <div id="prodSuccessMsg"></div>
            <div class="items-container" id="prodItemsContainer"></div>
            <button class="btn add-item-btn" onclick="addProdItem()">+ Th√™m M·∫∑t H√†ng</button>
            <button class="btn" onclick="saveProduction()">L∆∞u</button>
        </div>
        
        <!-- Export Product Screen -->
        <div id="exportProductScreen" style="display:none;">
            <button class="btn btn-secondary back-btn" onclick="backToMenu()">‚Üê Quay L·∫°i</button>
            <h2>Xu·∫•t Th√†nh Ph·∫©m</h2>
            <div id="exportSuccessMsg"></div>
            <div class="store-select">
                <label>Ch·ªçn Qu√°n</label>
                <select id="storeSelect">
                    <option value="DH">DH</option>
                    <option value="NH">NH</option>
                    <option value="HXH">HXH</option>
                    <option value="PY">PY</option>
                </select>
            </div>
            <div class="items-container" id="exportItemsContainer"></div>
            <button class="btn add-item-btn" onclick="addExportItem()">+ Th√™m M·∫∑t H√†ng</button>
            <button class="btn" onclick="saveExport()">L∆∞u</button>
        </div>
        
        <!-- Inventory Screen -->
        <div id="inventoryScreen" style="display:none;">
            <button class="btn btn-secondary back-btn" onclick="backToMenu()">‚Üê Quay L·∫°i</button>
            <h2>T·ªìn Kho</h2>
            <div class="search-box">
                <input type="text" id="inventorySearch" placeholder="üîç T√¨m ki·∫øm m·∫∑t h√†ng..." onkeyup="searchInventory()" />
            </div>
            <table id="inventoryTable">
                <thead>
                    <tr>
                        <th>Danh M·ª•c</th>
                        <th>M·∫∑t H√†ng</th>
                        <th>S·ªë L∆∞·ª£ng</th>
                        <th>Thao T√°c</th>
                    </tr>
                </thead>
                <tbody id="inventoryBody"></tbody>
            </table>
        </div>
        
        <!-- Alerts Screen -->
        <div id="alertsScreen" style="display:none;">
            <button class="btn btn-secondary back-btn" onclick="backToMenu()">‚Üê Quay L·∫°i</button>
            <h2>C·∫£nh B√°o H√†ng S·∫Øp H·∫øt</h2>
            <div id="alertsContainer"></div>
        </div>
    </div>

   

    <script>
        // Supabase configuration - REPLACE WITH YOUR CREDENTIALS
        const SUPABASE_URL = 'https://tyuufjwutazjfuiawiul.supabase.co'; 
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InR5dXVmand1dGF6amZ1aWF3aXVsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA1MDk4OTIsImV4cCI6MjA3NjA4NTg5Mn0.8WEsb2tBD6akNA9h9tR9zIAqjkZz0xZYVNbYCx2dEbc';
        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
        
        // Categories and items
        const categories = {
             "üçï Th√†nh ph·∫©m": [
    'ƒê·∫ø L',
    'ƒê·∫ø S',
    'Ph√¥ Mai L',
    'Ph√¥ Mai S',
    'B√≤ pizza (b·ªãch)',
    'B√≤ m√¨ √ù (b·ªãch)',
    'G√† pizza (b·ªãch)',
    'T√¥m (b·ªãch)',
    'M·ª±c (b·ªãch)',
    'C√° Ng·ª´ (b·ªãch)',
    'XXH (b·ªãch)',
    'XXƒê (b·ªãch)',
    'Ba R·ªçi (b·ªãch)',
    'B√≤ s·ªët cay (b·ªãch)',
    'S·ªët s·ªØa (b·ªãch)',
    'S·ªët c√† (h≈©)',
    'S·ªët G√†',
    'Salami (b·ªãch)',
    'ƒê√πi G√† (c√°i)',
    'ƒê√° Me (b·ªãch)',
    'G√† L·∫Øc (b·ªãch)',
    'XX Chi√™n X√π',
    'M·ª©t ƒë√†o (b·ªãch)',
    'KTC (b·ªãch)',
    'Tok (b·ªãch)',
    'Mi·∫øng ƒë√†o (b·ªãch)',
    'N·∫•m (b·ªãch)',
    'B√¥ng C·∫£i Xanh (b·ªãch)',
    'Bom Ph√¥ Mai (vi√™n)'
  ],

  "ü•© Nguy√™n li·ªáu s·ªëng": [
    'Ph√¥ mai cam',
    'Ph√¥ mai Topping',
    'Ph√¥ Mai Emborg',
    'Ph√¥ mai tr·∫Øng',
    'Ph√¥ mai v√†ng',
    'Ph√¥ mai t∆∞∆°i',
    'B√≤ nguy√™n',
    'G√† ·ª©c',
    'ƒê√πi G√†',
    'B√≤ Mi·∫øng S·ªëng',
    'T√¥m s·ªëng (ph·∫ßn)',
    'M·ª±c s·ªëng (ph·∫ßn)',
    'Thanh Cua Nguy√™n',
    'Ba R·ªçi Nguy√™n',
    'M√¨ √ù Nguy√™n',
    'B·∫Øp (Kg)',
    'C√† chua',
    'C√† r·ªët',
    'H√†nh T√¢y',
    'Khoai T√¢y (C·ªß)',
    'Khoai T√¢y Chi√™n Nguy√™n'
  ],

  "üßÇ Gia v·ªã & nguy√™n li·ªáu kh√¥": [
    'Men (b√¨)',
    'B·ªôt (bao)',
    'ƒê∆∞·ªùng (b√¨)',
    'Mu·ªëi (b√¨)',
    'X√¨ d·∫ßu (chai)',
    'R∆∞·ª£u (chai)',
    'Ti√™u',
    'D·∫ßu ƒÉn (can)',
    'D·∫ßu H√†o (chai)'
  ],

  "üì¶ Bao b√¨ & v·∫≠t d·ª•ng": [
    'Bao 1 m√≥n (kg)',
    'Bao c√¢n b√≤ (kg)',
    'Bao c√¢n m√¨ (kg)',
    'B√¨ v√†ng (kg)',
    'Bao Pizza L·ªõn (kg)',
    'Bao r√°c (kg)',
    'D√¢y thun (b·ªãch)',
    'Ly nh·ª±a (l·ªëc)',
    'Bao ƒê·∫ø L (kg)',
    'Bao ƒê·∫ø S (kg)'
  ],

  "ü•§ ƒê·ªì u·ªëng & b√°nh": [
    'Coca chai',
    'Coca lon',
    'N∆∞·ªõc su·ªëi',
    'Bia Blance',
    'Bia Quy Nh∆°n',
    'B√°nh m√¨'
  ]
        };
        
        
        // Set default date to today
        document.getElementById('loginDate').valueAsDate = new Date();
        
        const users = {
    "Bo": "123456",
    "Nhu2k6": "Xinh@Dep",
    "Ngan2k2": "Dep$Gioi",
    "admin": "123"
};

let currentDate = '';
let currentUser = '';

function login() {
        const date = document.getElementById('loginDate').value;
        const name = document.getElementById('loginName').value.trim();
        const password = document.getElementById('loginPassword').value;

        if (!date || !name || !password) {
            alert('Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß th√¥ng tin!');
            return;
        }

        if (!(name in users) || users[name] !== password) {
            alert('T√™n ng∆∞·ªùi d√πng ho·∫∑c m·∫≠t kh·∫©u kh√¥ng ƒë√∫ng!');
            return;
        }

        currentDate = date;
        currentUser = name;

        localStorage.setItem('currentDate', currentDate);
        localStorage.setItem('currentUser', currentUser);

        document.getElementById('loginScreen').classList.remove('active');
        document.getElementById('mainScreen').classList.add('active');

        document.getElementById('currentDate').textContent = currentDate;
        document.getElementById('currentUser').textContent = currentUser;

        loadInventory();
    }

    function logout() {
        currentDate = '';
        currentUser = '';
        localStorage.removeItem('currentDate');
        localStorage.removeItem('currentUser');

        document.getElementById('mainScreen').classList.remove('active');
        document.getElementById('loginScreen').classList.add('active');

        document.getElementById('loginDate').value = '';
        document.getElementById('loginName').value = '';
        document.getElementById('loginPassword').value = '';
    }

    // --- Load Inventory ---
    async function loadInventory() {
        const { data, error } = await supabase
            .from('inventory')
            .select('*');

        if (error) {
            console.error('L·ªói load inventory:', error);
            return;
        }

        inventoryData = {};
        data.forEach(row => {
            inventoryData[row.item] = row.quantity;
        });

        displayInventory();
        displayAlerts();
    }

    // --- Update Inventory v√† log ---
        async function updateInventory(itemName, quantityChange, type = 'manual', store = null) {
            const currentQty = inventoryData[itemName] || 0;
            const newQty = currentQty + quantityChange;
            inventoryData[itemName] = newQty;

            // C·∫≠p nh·∫≠t Supabase inventory
            const { error: invError } = await supabase
                .from('inventory')
                .upsert({ item: itemName, quantity: newQty }, { onConflict: 'item' });

            if (invError) console.error('‚ùå L·ªói ghi inventory:', invError);

            // Ghi log theo lo·∫°i giao d·ªãch
            const today = new Date().toISOString().slice(0, 10);

            if (type === 'raw_input') {
                const { error } = await supabase.from('raw_materials_input').insert([{
                    date: today,
                    user_name: currentUser,
                    item: itemName,
                    quantity: quantityChange
                }]);
                if (error) console.error('‚ùå L·ªói ghi raw_materials_input:', error);

            } else if (type === 'production') {
                const { error } = await supabase.from('production').insert([{
                    date: today,
                    user_name: currentUser,
                    item: itemName,
                    quantity: quantityChange
                }]);
                if (error) console.error('‚ùå L·ªói ghi production:', error);

            } else if (type === 'export') {
                const { error } = await supabase.from('exports').insert([{
                    date: today,
                    user_name: currentUser,
                    store: store,
                    item: itemName,
                    quantity: quantityChange
                }]);
                if (error) console.error('‚ùå L·ªói ghi exports:', error);
            }


        displayInventory();
        displayAlerts();
    }

    // --- Item Row UI ---
    function createItemRow(containerId, categoryList) {
        const container = document.getElementById(containerId);
        const row = document.createElement('div');
        row.className = 'item-row';

        let optionsHTML = '<option value="">-- Ch·ªçn m·∫∑t h√†ng --</option>';
        for (let cat in categoryList) {
            optionsHTML += `<optgroup label="${cat}">`;
            categoryList[cat].forEach(item => {
                optionsHTML += `<option value="${item}">${item}</option>`;
            });
            optionsHTML += '</optgroup>';
        }

        row.innerHTML = `
            <select class="item-select">${optionsHTML}</select>
            <input type="number" class="item-quantity" placeholder="S·ªë l∆∞·ª£ng" min="0" step="0.1" />
            <button class="btn btn-danger btn-small" onclick="this.parentElement.remove()">X√≥a</button>
        `;

        container.appendChild(row);
    }

    function getItemsFromContainer(containerId) {
        const container = document.getElementById(containerId);
        const rows = container.querySelectorAll('.item-row');
        const items = [];

        rows.forEach(row => {
            const name = row.querySelector('.item-select').value;
            const quantity = parseFloat(row.querySelector('.item-quantity').value);
            if (name && quantity > 0) items.push({ name, quantity });
        });

        return items;
    }

    // --- Init c√°c m√†n h√¨nh ---
    function initRawInput() {
        document.getElementById('rawItemsContainer').innerHTML = '';
        document.getElementById('rawSuccessMsg').innerHTML = '';
        addRawItem();
    }

    function addRawItem() {
        const rawCategories = {
            'ü•© Nguy√™n li·ªáu s·ªëng': categories['ü•© Nguy√™n li·ªáu s·ªëng'],
            'üßÇ Gia v·ªã & nguy√™n li·ªáu kh√¥': categories['üßÇ Gia v·ªã & nguy√™n li·ªáu kh√¥'],
            'üì¶ Bao b√¨ & v·∫≠t d·ª•ng': categories['üì¶ Bao b√¨ & v·∫≠t d·ª•ng'],
            'ü•§ ƒê·ªì u·ªëng & b√°nh': categories['ü•§ ƒê·ªì u·ªëng & b√°nh']
        };
        createItemRow('rawItemsContainer', rawCategories);
    }

    function initProdInput() {
        document.getElementById('prodItemsContainer').innerHTML = '';
        document.getElementById('prodSuccessMsg').innerHTML = '';
        addProdItem();
    }

    function addProdItem() {
        createItemRow('prodItemsContainer', {'üçï Th√†nh ph·∫©m': categories['üçï Th√†nh ph·∫©m']});
    }

    function initExportInput() {
        document.getElementById('exportItemsContainer').innerHTML = '';
        document.getElementById('exportSuccessMsg').innerHTML = '';
        addExportItem();
    }

    function addExportItem() {
        createItemRow('exportItemsContainer', {
            'üçï Th√†nh ph·∫©m': categories['üçï Th√†nh ph·∫©m'],
            'üßÇ Gia v·ªã & nguy√™n li·ªáu kh√¥': categories['üßÇ Gia v·ªã & nguy√™n li·ªáu kh√¥'],
            'üì¶ Bao b√¨ & v·∫≠t d·ª•ng': categories['üì¶ Bao b√¨ & v·∫≠t d·ª•ng'],
            'ü•§ ƒê·ªì u·ªëng & b√°nh': categories['ü•§ ƒê·ªì u·ªëng & b√°nh']
        });
    }

    // --- Save functions ---
    async function saveRawInput() {
        const items = getItemsFromContainer('rawItemsContainer');
        if (!items.length) return;
        for (let item of items) await updateInventory(item.name, item.quantity, 'raw_input');
        document.getElementById('rawSuccessMsg').innerHTML = '<div class="success-msg">‚úì ƒê√£ l∆∞u th√†nh c√¥ng!</div>';
        setTimeout(() => initRawInput(), 2000);
    }

    async function saveProduction() {
        const items = getItemsFromContainer('prodItemsContainer');
        if (!items.length) return;
        for (let item of items) await updateInventory(item.name, item.quantity, 'production');
        document.getElementById('prodSuccessMsg').innerHTML = '<div class="success-msg">‚úì ƒê√£ l∆∞u th√†nh c√¥ng!</div>';
        setTimeout(() => initProdInput(), 2000);
    }

    async function saveExport() {
        const store = document.getElementById('storeSelect').value;
        const items = getItemsFromContainer('exportItemsContainer');
        if (!items.length) return;
        for (let item of items) await updateInventory(item.name, -item.quantity, 'export', store);
        document.getElementById('exportSuccessMsg').innerHTML = '<div class="success-msg">‚úì ƒê√£ xu·∫•t h√†ng th√†nh c√¥ng!</div>';
        setTimeout(() => initExportInput(), 2000);
    }

    // --- Display Inventory & Alerts ---
    function displayInventory() {
        const tbody = document.getElementById('inventoryBody');
        if (!tbody) return;
        tbody.innerHTML = '';

        for (let cat in categories) {
            categories[cat].forEach(item => {
                const qty = inventoryData[item] || 0;
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${cat}</td>
                    <td>${item}</td>
                    <td><input type="number" value="${qty}" step="0.1"
                        onchange="updateInventoryDirect('${item}', this.value)"
                        style="width:100px" /></td>
                    <td>${qty < 3 ? '‚ö†Ô∏è S·∫Øp h·∫øt' : '‚úì ƒê·ªß'}</td>
                `;
            });
        }
    }

    function updateInventoryDirect(itemName, newValue) {
        const diff = (parseFloat(newValue) || 0) - (inventoryData[itemName] || 0);
        updateInventory(itemName, diff, 'manual');
    }

    function displayAlerts() {
        const container = document.getElementById('alertsContainer');
        container.innerHTML = '';
        let lowStockItems = [];

        for (const [groupName, items] of Object.entries(categories)) {
            items.forEach(item => {
                const qty = parseFloat(inventoryData[item] || 0);
                if (qty < 3) lowStockItems.push({ name: item, quantity: qty, group: groupName });
            });
        }

        if (!lowStockItems.length) {
            container.innerHTML = '<div class="alert">‚úì Kh√¥ng c√≥ m·∫∑t h√†ng n√†o s·∫Øp h·∫øt!</div>';
        } else {
            let html = '<div class="alert">';
            lowStockItems.forEach(item => {
                html += `<div class="alert-item">‚ö†Ô∏è [${item.group}] <strong>${item.name}</strong>: ${item.quantity}</div>`;
            });
            html += '</div>';
            container.innerHTML = html;
        }
    }

    // --- Navigation ---
    function showScreen(screen) {
        document.getElementById('mainScreen').style.display = 'none';
        ['rawInputScreen','productionInputScreen','exportProductScreen','inventoryScreen','alertsScreen']
            .forEach(s => document.getElementById(s).style.display='none');

        switch(screen) {
            case 'rawInput': document.getElementById('rawInputScreen').style.display='block'; initRawInput(); break;
            case 'productionInput': document.getElementById('productionInputScreen').style.display='block'; initProdInput(); break;
            case 'exportProduct': document.getElementById('exportProductScreen').style.display='block'; initExportInput(); break;
            case 'inventory': document.getElementById('inventoryScreen').style.display='block'; displayInventory(); break;
            case 'alerts': document.getElementById('alertsScreen').style.display='block'; displayAlerts(); break;
        }
    }

    function backToMenu() {
        ['rawInputScreen','productionInputScreen','exportProductScreen','inventoryScreen','alertsScreen']
            .forEach(s => document.getElementById(s).style.display='none');
        document.getElementById('mainScreen').style.display='block';
    }      
    </script>
</body>
</html>
